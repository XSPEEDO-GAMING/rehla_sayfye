<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ - ุงูุฑุญูุฉ ุงูุตูููุฉ</title>
    <link rel="stylesheet" href="style_home.css">
</head>
<body>
    <!-- ููุฏูู ุฎูููุฉ ูุนุตุงููุฑ ุชุทูุฑ ููู ุงูุจุญุฑ ูุน ุตูุช -->
    <video id="bg-video" autoplay loop muted playsinline style="position:fixed;top:0;left:0;width:100vw;height:100vh;object-fit:cover;z-index:-1;">
        <source src="https://cdn.pixabay.com/video/2023/03/14/157234-810015382_large.mp4" type="video/mp4">
        ูุชุตูุญู ูุง ูุฏุนู ุชุดุบูู ุงูููุฏูู.
    </video>
    <audio id="birds-audio" src="https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae5e2.mp3" autoplay loop></audio>

    <!-- ุนุฏุงุฏ ุงูููููุฒ ูู ุงูุฒุงููุฉ -->
    <div id="coins-counter" style="position:fixed;top:20px;left:20px;z-index:1000;background:#fffbe7;border-radius:20px;padding:8px 18px;box-shadow:0 2px 8px #0002;display:flex;align-items:center;font-weight:bold;font-size:1.1em;">
        <img src="https://cdn-icons-png.flaticon.com/512/138/138292.png" alt="ููููุฒ" style="width:28px;height:28px;margin-left:8px;">
        <span id="coins-value">0</span> ููููุฒ
    </div>

    <!-- ุฒุฑ ุดุฑุงุก ููููุฒ -->
    <div id="buy-coins-btn" 
         onclick="window.location.href='cio.html'"
         style="position:fixed;top:20px;right:20px;z-index:1001;cursor:pointer;background:#fffbe7;border-radius:50%;box-shadow:0 2px 8px #0002;width:48px;height:48px;display:flex;align-items:center;justify-content:center;transition:box-shadow 0.2s;">
        <img src="https://cdn-icons-png.flaticon.com/512/138/138292.png" alt="ุดุฑุงุก ููููุฒ" style="width:32px;height:32px;">
    </div>

    <div class="home-container">
        <img id="user-img" class="user-image" src="" alt="ุตูุฑุฉ ุงููุณุชุฎุฏู" style="display:none;">
        <h2 id="welcome-msg">ูุฑุญุจุงู ุจู ูู ุงูุฑุญูุฉ ุงูุตูููุฉ</h2>
        <p>ูุฐู ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูููููุน.</p>
        <div class="info">
            <h3>ูุนูููุงุช ุนู ุงูุฑุญูุฉ ุงูุญุงููุฉ:</h3>
            <ul>
                <li>ุงููุฌูุฉ: ูุฑุณู ูุทุฑูุญ</li>
                <li>ุงูุชุงุฑูุฎ: 3 ููููู 2025</li>
                <li>ุนุฏุฏ ุงูุฃูุงู: 7 ุฃูุงู</li>
                <li>ุงูุฅูุงูุฉ: ููุฏู 5 ูุฌูู</li>
                <li>ุงูุฃูุดุทุฉ: ุณุจุงุญุฉุ ุฃูุนุงุจ ุดุงุทุฆูุฉุ ุฌููุงุช ุณูุงุญูุฉ</li>
            </ul>
        </div>
        <div class="actions">
            <div style="margin-bottom: 10px;">
                <label for="persons">ุนุฏุฏ ุงูุฃูุฑุงุฏ:</label>
                <input type="number" id="persons" min="1" value="1" style="width:50px; border-radius:8px; border:1px solid #bbb; text-align:center;">
                <span id="coins-needed" style="color:#ff9800; font-weight:bold;">(10 ููููุฒ)</span>
                <span style="margin-right:10px;cursor:pointer;" title="ุดุฑุงุก ููููุฒ" onclick="window.location.href='cio.html'">
                    ๐ช
                </span>
            </div>
            <button onclick="subscribeTrip()">ุงุดุชุฑู ูู ุงูุฑุญูุฉ</button>
            <button onclick="showBookingDetails()">ุชูุงุตูู ุงูุญุฌุฒ</button>
            <button onclick="alert('ุณูุชู ุฅุถุงูุฉ ูุนุฑุถ ุงูุตูุฑ ูุฑูุจุงู')">ูุนุฑุถ ุงูุตูุฑ</button>
        </div>
        <div class="other-trips">
            <h3>ุฑุญูุงุช ุฃุฎุฑู ูุชุงุญุฉ:</h3>
            <ul>
                <li>ุฑุญูุฉ ุฅูู ุงูุฃูุตุฑ ูุฃุณูุงู - ุฃุบุณุทุณ 2025</li>
                <li>ุฑุญูุฉ ุฅูู ุดุฑู ุงูุดูุฎ - ุณุจุชูุจุฑ 2025</li>
                <li>ุฑุญูุฉ ุฅูู ุงูุบุฑุฏูุฉ - ุฃูุชูุจุฑ 2025</li>
            </ul>
        </div>
    </div>
    <script>
        // ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ูุตูุฑุชู ุฅุฐุง ูุงู ูุณุฌูุงู
        const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
        const img = document.getElementById('user-img');
        if (currentUser) {
            document.getElementById('welcome-msg').textContent = 'ูุฑุญุจุงู ' + currentUser.username + ' ูู ุงูุฑุญูุฉ ุงูุตูููุฉ';
            if (currentUser.image) {
                img.src = currentUser.image;
                img.style.display = 'block';
                img.style.cursor = "pointer";
                img.title = "ุงุถุบุท ูุชุบููุฑ ุงูุตูุฑุฉ";
                img.style.borderRadius = "50%"; // ุฏุงุฆุฑู ุจุงูุบุตุจ
                img.style.objectFit = "cover";  // ุฏุงุฆุฑู ุจุงูุบุตุจ

                // ุฒุฑ ูุณุญ ุงูุตูุฑุฉ
                let delBtn = document.createElement('button');
                delBtn.textContent = "ูุณุญ ุงูุตูุฑุฉ";
                delBtn.style.margin = "10px auto";
                delBtn.style.display = "block";
                delBtn.style.background = "#f44336";
                delBtn.style.color = "#fff";
                delBtn.style.border = "none";
                delBtn.style.borderRadius = "20px";
                delBtn.style.padding = "5px 15px";
                delBtn.style.cursor = "pointer";
                delBtn.onclick = function () {
                    // ุนูุฏ ุงููุณุญุ ุงุญุฐู ุงูุตูุฑุฉ ูู ุงููุณุชุฎุฏู
                    delete currentUser.image;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    // ุญุฏุซ ุจูุงูุงุช ุงููุณุชุฎุฏููู
                    let users = JSON.parse(localStorage.getItem('users') || '[]');
                    let idx = users.findIndex(u => u.username === currentUser.username);
                    if (idx !== -1) {
                        delete users[idx].image;
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                    img.style.display = 'none';
                    delBtn.remove();
                    showInitialsAvatar();
                };
                img.parentNode.insertBefore(delBtn, img.nextSibling);

                // ุชุบููุฑ ุงูุตูุฑุฉ ุนูุฏ ุงูุถุบุท
                img.onclick = function () {
                    let fileInput = document.createElement('input');
                    fileInput.type = 'file';
                    fileInput.accept = 'image/*';
                    fileInput.style.display = 'none';
                    document.body.appendChild(fileInput);
                    fileInput.onchange = function () {
                        const file = fileInput.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function (event) {
                                img.src = event.target.result;
                                img.style.borderRadius = "50%"; // ุฏุงุฆุฑู ุจุงูุบุตุจ
                                img.style.objectFit = "cover";  // ุฏุงุฆุฑู ุจุงูุบุตุจ
                                currentUser.image = event.target.result;
                                let users = JSON.parse(localStorage.getItem('users') || '[]');
                                let idx = users.findIndex(u => u.username === currentUser.username);
                                if (idx !== -1) {
                                    users[idx].image = event.target.result;
                                    localStorage.setItem('users', JSON.stringify(users));
                                }
                                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                            };
                            reader.readAsDataURL(file);
                        }
                        fileInput.remove();
                    };
                    fileInput.click();
                };
            } else {
                img.style.display = 'none';
                showInitialsAvatar();
            }
        }

        // ุฏุงูุฉ ูุฅุธูุงุฑ ุฏุงุฆุฑุฉ ููููุฉ ูููุง ุฃูุงุฆู ุญุฑูู ุงุณู ุงููุณุชุฎุฏู ูุน ุฒุฑ ุฅุถุงูุฉ ุตูุฑุฉ
        function showInitialsAvatar() {
            // ุฅุฒุงูุฉ ุฃู ุฏุงุฆุฑุฉ ุฃู ุฒุฑ ุณุงุจู
            let oldAvatar = document.getElementById('initials-avatar');
            if (oldAvatar) oldAvatar.remove();
            let oldAdd = document.getElementById('add-img-btn');
            if (oldAdd) oldAdd.remove();

            // ุฅูุดุงุก ุฏุงุฆุฑุฉ ุงูุญุฑูู
            let initials = (currentUser.username || '').split(' ').map(w => w[0]).join('').slice(0,2).toUpperCase();
            let colors = [
                "#f44336", "#e91e63", "#9c27b0", "#3f51b5", "#2196f3", "#009688", "#4caf50", "#ff9800", "#795548"
            ];
            // ููู ุซุงุจุช ููู ูุณุชุฎุฏู ุญุณุจ ุงุณูู
            let color = colors[(currentUser.username.charCodeAt(0) + (currentUser.username.charCodeAt(1)||0)) % colors.length];

            let avatar = document.createElement('div');
            avatar.id = "initials-avatar";
            avatar.style.width = "80px";
            avatar.style.height = "80px";
            avatar.style.borderRadius = "50%";
            avatar.style.background = color;
            avatar.style.display = "flex";
            avatar.style.alignItems = "center";
            avatar.style.justifyContent = "center";
            avatar.style.margin = "20px auto 10px auto";
            avatar.style.fontSize = "32px";
            avatar.style.color = "#fff";
            avatar.style.fontWeight = "bold";
            avatar.style.userSelect = "none";
            avatar.textContent = initials;

            // ุฒุฑ ุฅุถุงูุฉ ุตูุฑุฉ
            let addImgBtn = document.createElement('div');
            addImgBtn.id = "add-img-btn";
            addImgBtn.title = "ุงุถุบุท ูุฅุถุงูุฉ ุตูุฑุฉ";
            addImgBtn.style.width = "32px";
            addImgBtn.style.height = "32px";
            addImgBtn.style.borderRadius = "50%";
            addImgBtn.style.background = "#fff";
            addImgBtn.style.display = "flex";
            addImgBtn.style.alignItems = "center";
            addImgBtn.style.justifyContent = "center";
            addImgBtn.style.position = "relative";
            addImgBtn.style.left = "50%";
            addImgBtn.style.transform = "translateX(-50%)";
            addImgBtn.style.marginTop = "-30px";
            addImgBtn.style.marginBottom = "10px";
            addImgBtn.style.boxShadow = "0 2px 8px #0002";
            addImgBtn.style.cursor = "pointer";
            addImgBtn.style.fontSize = "22px";
            addImgBtn.style.color = "#2196f3";
            addImgBtn.innerHTML = "&#43;";

            addImgBtn.onclick = function () {
                let fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = 'image/*';
                fileInput.style.display = 'none';
                document.body.appendChild(fileInput);
                fileInput.onchange = function () {
                    const file = fileInput.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function (event) {
                            img.src = event.target.result;
                            img.style.display = 'block';
                            img.style.borderRadius = "50%"; // ุฏุงุฆุฑู ุจุงูุบุตุจ
                            img.style.objectFit = "cover";  // ุฏุงุฆุฑู ุจุงูุบุตุจ
                            avatar.remove();
                            addImgBtn.remove();
                            currentUser.image = event.target.result;
                            let users = JSON.parse(localStorage.getItem('users') || '[]');
                            let idx = users.findIndex(u => u.username === currentUser.username);
                            if (idx !== -1) {
                                users[idx].image = event.target.result;
                                localStorage.setItem('users', JSON.stringify(users));
                            }
                            localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        };
                        reader.readAsDataURL(file);
                    }
                    fileInput.remove();
                };
                fileInput.click();
            };

            // ุฅุฏุฑุงุฌ ุงูุฏุงุฆุฑุฉ ูุฒุฑ ุงูุฅุถุงูุฉ ูุจู ููุงู ุงูุตูุฑุฉ
            img.parentNode.insertBefore(avatar, img);
            img.parentNode.insertBefore(addImgBtn, img);
        }

        // ุชุญุฏูุซ ุงูููููุฒ ุงููุทููุจุฉ ุญุณุจ ุนุฏุฏ ุงูุฃูุฑุงุฏ
        const personsInput = document.getElementById('persons');
        const coinsNeededSpan = document.getElementById('coins-needed');
        personsInput.addEventListener('input', function() {
            let n = parseInt(personsInput.value) || 1;
            coinsNeededSpan.textContent = "(" + (n * 10) + " ููููุฒ)";
        });

        function subscribeTrip() {
            let n = parseInt(personsInput.value) || 1;
            let needed = n * 10;
            let user = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (!user) {
                alert("ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู.");
                window.location.href = "index.html";
                return;
            }
            if ((user.coins || 0) < needed) {
                alert("ุฑุตูุฏู ุบูุฑ ูุงูู. ุชุญุชุงุฌ ุฅูู " + needed + " ููููุฒ. ููููู ุดุฑุงุก ุงููุฒูุฏ ูู ุงูููููุฒ.");
                return;
            }
            user.coins -= needed;
            localStorage.setItem('currentUser', JSON.stringify(user));
            // ุชุญุฏูุซ ุงูููููุฒ ูู users ุฃูุถุงู
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            let idx = users.findIndex(u => u.username === user.username);
            if (idx !== -1) {
                users[idx].coins = user.coins;
                localStorage.setItem('users', JSON.stringify(users));
            }
            alert("ุชู ุงูุงุดุชุฑุงู ูู ุงูุฑุญูุฉ ุจูุฌุงุญ ูุนุฏุฏ " + n + " ุฃูุฑุงุฏ!\nุฑุตูุฏู ุงููุชุจูู: " + user.coins + " ููููุฒ");
        }

        // ุชุญุฏูุซ ุนุฏุงุฏ ุงูููููุฒ ูู ุงูุฒุงููุฉ
        function updateCoinsCounter() {
            const user = JSON.parse(localStorage.getItem('currentUser') || 'null');
            document.getElementById('coins-value').textContent = user && user.coins ? user.coins : 0;
        }
        updateCoinsCounter();

        // ุนูุฏ ุดุฑุงุก ุฃู ุฎุตู ููููุฒ ูู ุงููุณุชุฎุฏูุ ุงุณุชุฏุนู updateCoinsCounter()
        // ูุซุงู: ุจุนุฏ ุงูุงุดุชุฑุงู ูู ุงูุฑุญูุฉ
        function subscribeTrip() {
            let n = parseInt(personsInput.value) || 1;
            let needed = n * 10;
            let user = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (!user) {
                alert("ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู.");
                window.location.href = "index.html";
                return;
            }
            if ((user.coins || 0) < needed) {
                alert("ุฑุตูุฏู ุบูุฑ ูุงูู. ุชุญุชุงุฌ ุฅูู " + needed + " ููููุฒ. ููููู ุดุฑุงุก ุงููุฒูุฏ ูู ุงูููููุฒ.");
                return;
            }
            user.coins -= needed;
            localStorage.setItem('currentUser', JSON.stringify(user));
            // ุชุญุฏูุซ ุงูููููุฒ ูู users ุฃูุถุงู
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            let idx = users.findIndex(u => u.username === user.username);
            if (idx !== -1) {
                users[idx].coins = user.coins;
                localStorage.setItem('users', JSON.stringify(users));
            }
            alert("ุชู ุงูุงุดุชุฑุงู ูู ุงูุฑุญูุฉ ุจูุฌุงุญ ูุนุฏุฏ " + n + " ุฃูุฑุงุฏ!\nุฑุตูุฏู ุงููุชุจูู: " + user.coins + " ููููุฒ");
            updateCoinsCounter();
        }

        // ุฅุฐุง ูุงู ูุฏูู ุนูููุงุช ุดุฑุงุก ููููุฒ ูู ุตูุญุฉ ุฃุฎุฑูุ ุงุณุชุฏุนู updateCoinsCounter() ุนูุฏ ุงูุนูุฏุฉ ููุตูุญุฉ
        window.addEventListener('focus', updateCoinsCounter);

        function showBookingDetails() {
            alert(
                "ุชูุงุตูู ุงูุญุฌุฒ:\n\n" +
                "1- ููุงุดุชุฑุงู ูู ุงูุฑุญูุฉ ูุฌุจ ุฃู ุชูุชูู ููููุฒ ูุงููุฉ (ูู ูุฑุฏ ูุญุชุงุฌ 10 ููููุฒ).\n" +
                "2- ููููู ุดุฑุงุก ุงูููููุฒ ูู ุฎูุงู ุงูุถุบุท ุนูู ุนูุงูุฉ ุงูููููุฒ ูู ุงูุฒุงููุฉ ุฃู ุฒุฑ ๐ช.\n" +
                "3- ุนูุฏ ุดุฑุงุก ุงูููููุฒุ ุณูุชู ุฎุตู ุซูููุง ูู ุญุณุงุจู ุงูุจููู ุจุนุฏ ุฅุฏุฎุงู ุจูุงูุงุชู ุงูุจูููุฉ.\n" +
                "4- ุจุนุฏ ุดุฑุงุก ุงูููููุฒุ ููููู ุงุณุชุฎุฏุงููุง ููุงุดุชุฑุงู ูู ุงูุฑุญูุงุช ุงููุฎุชููุฉ.\n" +
                "5- ุณุนุฑ ุงููููู ุงููุงุญุฏ: 50 ุฌููู ูุตุฑู.\n" +
                "6- ุนูุฏ ุงูุงุดุชุฑุงูุ ุณูุชู ุฎุตู ุงูููููุฒ ุงููุทููุจุฉ ุชููุงุฆูุงู ูู ุฑุตูุฏู."
            );
        }
    </script>
</body>
</html>